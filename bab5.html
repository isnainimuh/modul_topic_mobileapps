<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Target Week 5 ‚Äì Authentication (JWT dengan Laravel Sanctum)</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.css">
</head>
<body>
  <header>
    <h1>Target Week 5 ‚Äì Authentication (JWT dengan Laravel Sanctum)</h1>
    <nav>
      <a href="index.html">üè† Daftar Materi</a> |
      <a href="bab4.html">‚¨ÖÔ∏è Target Sebelumnya</a> | 
      <a href="bab6.html">‚û°Ô∏è Target Berikutnya</a>
    </nav>
  </header>

  <main>
    <h2>Authentication dengan Laravel Sanctum</h2>
    <p>Pada bab sebelumnya, kita telah membangun RESTful API yang lengkap. 
      Pada bagian ini, kita tambahkan Authentication pada user.
      Untuk laravel 10, Sanctum sudah otomatis terinstall.
      Ketikkan kode ini untuk mengecek Sanctum sudah terinstall/belum. 
    </p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
composer show laravel/sanctum
      </code></pre>
    </div>

    <p>Jika belum terinstall, maka bisa install dengan kode berikut.</p>
        <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
composer require laravel/sanctum
      </code></pre>
    </div>
    <p>Kemudian update User Model untuk extends Authenticatable.</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
use Laravel\Sanctum\HasApiTokens;

class User extends Authenticatable
{
    use HasApiTokens, HasFactory, Notifiable;
    // ... existing code
}
      </code></pre>
    </div>
   
    <h3>Create AuthController</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
php artisan make:controller AuthController
      </code></pre>
    </div>
    <p>Lokasi file: app/Http/Controllers/AuthController.php</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code id="auth" class="language-php"></code></pre>
    </div>

    <h3>Add Auth Routes</h3>
    <p>Lokasi file: routes/api.php</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code id="routes" class="language-php"></code></pre>
    </div>

    <h3>Update Cart Model Relationship</h3>
    <p>Pada file app/Models/User.php tambahkan kode berikut.</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
public function cart()
{
    return $this->hasOne(Cart::class, 'user_id', 'user_id');
}
      </code></pre>
    </div>

    <h3>Test Authentication</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
POST http://ecommerce.test/api/register
{
    "username": "testuser",
    "email": "test@example.com",
    "password": "password123",
    "phone_number": "081234567890"
}
      </code></pre>
    </div>

    <figure>
      <img src="images/4register.png" alt="register" class="code-image">
      <figcaption>Gambar 4.1 Register sukses</figcaption>
    </figure>


    <h3>Login</h3>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-php">
POST http://ecommerce.test/api/login
{
    "email": "test@example.com",
    "password": "password123"
}
      </code></pre>
    </div>
    <p>Response akan include token untuk digunakan di header berikutnya.</p>
    <figure>
      <img src="images/4login.png" alt="login" class="code-image">
      <figcaption>Gambar 4.2 Login sukses</figcaption>
    </figure>

  </main>

  
  <footer>
    <a href="index.html">‚Üê Kembali</a>
  </footer>

  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script>
function loadCode(fileName, elementId) {
  fetch(fileName)
    .then(res => res.text())
    .then(code => {
      const el = document.getElementById(elementId);
      el.textContent = code;
      Prism.highlightElement(el);
    })
    .catch(err => console.error('Gagal memuat file:', err));
}
// memuat file langsung dari folder /codes/
loadCode('codes/4auth.txt', 'auth');
loadCode('codes/4routes.txt', 'routes');
</script>

</body>
</html>

